package avicit.discussion_manage.informationstatistics.controller;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.ServletRequestUtils;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;
import avicit.discussion_manage.informationstatistics.service.InformationStatisticsService;
import avicit.platform6.api.syspermissionresource.permissionanalysis.core.support.LoaderConstant;
import avicit.platform6.core.properties.PlatformConstant.OpResult;
@Controller
@Scope("prototype")
@RequestMapping("discussion_manage/informationstatistics/InformationStatisticsController")
public class InformationStatisticsController implements LoaderConstant{
	@Autowired
	private InformationStatisticsService service;
	/**
	 * 零件   装配件对应讨论区的数量统计
	 * @param request
	 * @param reponse
	 * @return
	 */
	@RequestMapping(value = "StructureManageInfo")
	public ModelAndView toStructureManage(HttpServletRequest request, HttpServletResponse reponse) {
		
		
		ModelAndView mav = new ModelAndView();
		String   blue=request.getParameter("blue");
System.out.println("blue============"+blue);
		//String json = ServletRequestUtils.getStringParameter(request, "datas", "");
		
		List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			//result=service.searchStructureManage();
	
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<graph showNames='1' decimalPrecision='0' caption='零件   装配件讨论区数量统计图' formatNumberScale='0' baseFontSize='18'>");
		
			
			   // for (int i=0;i<result.size();i++) {
					//if(result.get(i).get("TYPE").equals("1")){
					htmlStr.append("<set name='装配件' color='99CC33' value='200000' isSliced='1' link='n-avicit/discussion_manage/informationstatistics/informationstatistics1.jsp'/>");  
				//	}else{
					htmlStr.append("<set name='零件' color='FF6600' value='297000' link='n-avicit/discussion_manage/informationstatistics/informationstatistics2.jsp'/>");
						
				//	}
			   // } 
			htmlStr.append("</graph>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics" );
		return mav;
	}
	
	
	/**
	 * 装配件审查讨论   审查确认   审查完成的统计图形
	 * @param request
	 * @param reponse
	 * @return
	 */
	@RequestMapping(value = "AuditOpinionInfo1")
	public ModelAndView toAuditOpinion(HttpServletRequest request, HttpServletResponse reponse) {
		ModelAndView mav = new ModelAndView();
		
		List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			//result=service.searchAuditOpinion();
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<graph showNames='1' decimalPrecision='0' caption='审查状态统计图' formatNumberScale='0' baseFontSize='18'>");
			//for (int i=0;i<result.size();i++) {
				htmlStr.append("<set name='审查讨论' color='FF6600' value='100000' isSliced='1'/><set name='审查确认'   color='99CC33' value='200000'/><set name='审查完成' color='FF9966' value='150000'/>");
			//}
			
			htmlStr.append("</graph>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics1");
		return mav;
	}
	/**
	 *零件审查讨论   审查确认   审查完成的统计图形
	 * @param request
	 * @param reponse
	 * @return
	 */
	@RequestMapping(value = "AuditOpinionInfo2")
	public ModelAndView toAuditOpinion1(HttpServletRequest request, HttpServletResponse reponse) {
		ModelAndView mav = new ModelAndView();
		
		List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			//result=service.searchAuditOpinion();
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<graph showNames='1' decimalPrecision='0' caption='审查状态统计图' formatNumberScale='0' baseFontSize='18'>");
			//for (int i=0;i<result.size();i++) {
				htmlStr.append("<set name='审查讨论' value='145000' color='FF6600' isSliced='1'/><set name='审查确认' color='99CC33' value='160000'/><set name='审查完成' color='FF9966' value='170000'/>");
			//}
			
			htmlStr.append("</graph>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics2");
		return mav;
	}
	
	/**
	 * 建议关闭状态的统计图形   已关闭  未关闭   争议性关闭
	 * @param request
	 * @param reponse
	 * @return
	 */
	@RequestMapping(value = "SuggestionClosedInfo")
	public ModelAndView toSuggestionClosed(HttpServletRequest request, HttpServletResponse reponse) {
		ModelAndView mav = new ModelAndView();
		
		List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			//result=service.searchSuggestionClosed();
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<graph showNames='1' decimalPrecision='0' caption='建议关闭状态的统计图' formatNumberScale='0' baseFontSize='18'>");
			   // for (int i=0;i<result.size();i++) {
					//if(result.get(i).get("STATUS").equals("0")){
					htmlStr.append("<set name='未关闭' value='1000' isSliced='1'/>");  
				//	}else if(result.get(i).get("STATUS").equals("1")){
						htmlStr.append("<set name='已关闭' color='99CC33' value='100000' />");
				//	}else{
				htmlStr.append("<set name='争议性关闭'  color='FF6600' value='100'/>");
				//	}
			 //   } 
			htmlStr.append("</graph>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics");
		return mav;
	}
	/**
	 * 各相关部门的建议统计
	 * @param request
	 * @param reponse
	 * @return
	 */
	@RequestMapping(value = "SuggestionStatisticalInfo")
	public ModelAndView toSuggestionStatistical(HttpServletRequest request, HttpServletResponse response) {
		response.setCharacterEncoding("utf-8");
		ModelAndView mav = new ModelAndView();
		
		//List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<chart palette='2' showBorder='0' borderThickness='0'   caption='相关部门建议统计图' shownames='1' showvalues='0' numberPrefix='' showSum='1' decimals='0' useRoundEdges='1' formatNumberScale='0' baseFontSize='18' ><categories><category label='强度' /><category label='质审' /><category label='标审' /><category label='重量' /><category label='强度' /></categories><dataset seriesName='争议性建议' color='99CC33' showValues='0'><set value='3456' /><set value='7890' /><set value='2145' /><set value='3452' /><set value='4545' /></dataset><dataset seriesName='常规性建议' color='FF6600' showValues='0'><set value='3453' /><set value='3232' /><set value='8665' /><set value='5454' /><set value='1111' /></dataset></chart>");
			//htmlStr.append("</chart>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics");
		return mav;
	}
}
