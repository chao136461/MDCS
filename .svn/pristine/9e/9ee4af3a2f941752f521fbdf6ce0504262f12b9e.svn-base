package avicit.discussion_manage.informationstatistics.controller;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;
import avicit.discussion_manage.informationstatistics.service.InformationStatisticsService;
import avicit.platform6.api.syspermissionresource.permissionanalysis.core.support.LoaderConstant;
import avicit.platform6.core.properties.PlatformConstant.OpResult;
@Controller
@Scope("prototype")
@RequestMapping("discussion_manage/informationstatistics/InformationStatisticsController")
public class InformationStatisticsController implements LoaderConstant{
	@Autowired
	private InformationStatisticsService service;
	@RequestMapping(value = "StructureManageInfo")
	public ModelAndView toStructureManage(HttpServletRequest request, HttpServletResponse reponse) {
		ModelAndView mav = new ModelAndView();
		
		List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			result=service.searchStructureManage();
	System.out.println("result========"+result);
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<graph showNames='1' decimalPrecision='0'>");
		
			/*
			    for (int i=0;i<result.size();i++) {
					if(result.get(i).get("TYPE").equals("1")){
					htmlStr.append("<set name='零件' value='"+result.get(i).get("NUM")+"' isSliced='1' link='P-index,width=600,height=500,toolbar=no,localtion=no, scrollbars=no,resizable=no-avicit/discussion_manage/informationstatistics/informationstatistics1.jsp'/>");  
					}else{
					htmlStr.append("<set name='装配件' value='"+result.get(i).get("NUM")+"' link='P-index,width=600,height=500,toolbar=no,localtion=no, scrollbars=no,resizable=no-avicit/discussion_manage/informationstatistics/informationstatistics1.jsp'/>");
						
					}
			    } */
			    for (int i=0;i<result.size();i++) {
					if(result.get(i).get("TYPE").equals("1")){
					htmlStr.append("<set name='零件' value='"+result.get(i).get("NUM")+"' isSliced='1' link='n-avicit/discussion_manage/informationstatistics/informationstatistics1.jsp'/>");  
					}else{
					htmlStr.append("<set name='装配件' value='"+result.get(i).get("NUM")+"' link='n-avicit/discussion_manage/informationstatistics/informationstatistics1.jsp'/>");
						
					}
			    } 
			htmlStr.append("</graph>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics");
		return mav;
	}
	
	
	
	@RequestMapping(value = "AuditOpinionInfo")
	public ModelAndView toAuditOpinion(HttpServletRequest request, HttpServletResponse reponse) {
		ModelAndView mav = new ModelAndView();
		
		//List<Map<String,Object>> result = new ArrayList<Map<String,Object>>();

		try {
			//result=service.searchStructureManage();
			StringBuffer htmlStr=new StringBuffer();
			    htmlStr.append("<graph showNames='1' decimalPrecision='0'>");
			//for (int i=0;i<result.size();i++) {
				htmlStr.append("<set name='审查讨论' value='4' isSliced='1'/><set name='审查确认' value='5'/><set name='审查完成' value='6'/>");
			//}
			
			htmlStr.append("</graph>");
			mav.addObject("htmlStr", htmlStr.toString());
			mav.addObject("flag", OpResult.success);
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			mav.addObject("flag", OpResult.failure);
		}
		
		mav.setViewName("avicit/discussion_manage/informationstatistics/informationstatistics1");
		return mav;
	}
}
